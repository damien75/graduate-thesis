\chapter{Literature Review and Experimental Setup}

\section{Literature Review}
\subsection{Cardiac Diffusion MRI}

Magnetic Resonance Imaging (MRI) is the imaging method that was used to acquire the data on which our results are based. It is non-invasive and is adapted to the analysis of soft-tissues \cite{bakermans2008}. We will explain briefly how it works and what information it gives us.

\subsubsection{Magnetic Moment of Nuclei}

Magnetic Resonance acquisitions rely on the physical properties of the body, and more specifically the most abundant nucleus which is hydrogen (H). Indeed water molecules ($H_2O$, therefore 2 nucleus of hydrogen in each molecule) represent more than 60\% of the entire body composition. This hydrogen nucleus H consists of 1 proton and 1 electron of opposite electrical charge. The proton spins around itself and therefore creates a magnetic moment which makes the nucleus behave like a magnet to the outside world.
\begin{figure}
    \centering
    \begin{subfigure}{.28\textwidth}
        \includegraphics[width=\textwidth]{figures/spin_cm}
        \caption{The hydrogen proton behaves like a magnetic dipole - Adapted from \cite{dipole}}
        \label{fig:hydrogen_magnet}
    \end{subfigure}
    \hfill
    \begin{subfigure}{.68\textwidth}
        \includegraphics[width=\textwidth]{figures/Precession_Larmor_2}
        \caption{The Larmor precession when an exterior magnetic field is present - \cite{hydrogen}}
        \label{fig:larmor_precession}
    \end{subfigure}
    \caption{Magnetic behavior of the hydrogen nucleus}
    \label{fig:hydrogen}
\end{figure}

Applying an external magnetic field $\mathbf{B_0}$ leads to a precession around the direction of $\mathbf{B_0}$ of the nuclear magnetic moment of the nucleus. Its magnetic moment will have a characteristic Larmor frequency $\omega_0$. All the magnetic moments of the nuclei in a specific region will average out to a net magnetization vector $\mathbf{M_0}$ aligned with $\mathbf{B_0}$. However, it is important to note that all protons will have a different phase and that the precession is asynchronous between all protons, as shown in \ref{fig:larmor_precession}.

Then the idea is to apply a secondary and much less intense magnetic field $\mathbf{B_1}$, with $||\mathbf{B_1}|| \simeq 10^{-6}||\mathbf{B_0}||$ in a direction in the plane orthogonal to the direction of $\mathbf{B_0}$, rotating around the direction of $\mathbf{B_0}$ with the Larmor frequency $\omega_0$ to bring the nuclei to resonance and out of their equilibrium, ie into an excited state, as shown in Fig. \ref{fig:spin_excitation}. A torque will indeed be applied to the magnetic moment of the nucleus, coming from the Lorentz force: $\tau = \mathbf{M} \times \mathbf{B_1}$ where $\mathbf{M}$ is the magnetic moment of the nucleus. This can be achieved by transmitting radio frequency (RF) pulses. Then the motion of all nucleii will be synchronized and will be in phase.

\begin{figure}
    \centering
    \includegraphics[width=.5\textwidth]{figures/spin_excitation}
    \caption{Torque effect on the magnetic moment of the proton $\mathbf{M}$ when applying an extra magnetic field $\mathbf{B_1}$}
    \label{fig:spin_excitation}
\end{figure}

Once the impulse stops, the protons will return to their non-excited states and in that process will emit another magnetic signal (weak compared to $\mathbf{B_0}$) that will be analyzed, since it is specific to each proton. This information will be used to understand the distribution of the orientations of the magnetic moments in the environment.

\subsubsection{Using Magnetic Resonance for Imaging}

Once a nucleus is in its excited state, its relaxation as illustrated in Fig. \ref{fig:spin_relaxation} and the outcome magnetization vector in the $(x, y)$ plane $\mathbf{M_{x, y}}$ induces a current recorded by a RF receiving coil.
\begin{figure}
    \centering
    \includegraphics[width=.5\textwidth]{figures/spin_relaxation}
    \caption{Relaxation of the magnetic spin after the magnetic pulse $\mathbf{B_1}$ stops}
    \label{fig:spin_relaxation}
\end{figure}

This is the signal that is measured in a MR experiment and will be used to acquire the data.

For acquisitions in 2D or 3D, gradients are applied to the RF pulse(so that the excitation of molecules is characteristic to a location. As a result, the receiving coil can differentiate the localization of the signal more easily depending on this modulation. Typically in 2D frequency and phase encoding is used for the 2 degrees of freedom. In 3D slice selection is accomplished via a linear magnetic gradient, so that the main exterior magnetic field $\mathbf{B_0}(z)$ is different for each slice and leads to different Larmor values for each value of $z$.

In our case all MRI are acquired ex-vivo, which means that the acquisition process is more simple as the subject is perfectly still and several acquisitions can be performed without having to worry about the subject's motion. In the presence of subject motion more elaborate methods have to be applied like FLASH imaging.

Standard MRI is based mainly on the specific relaxation properties of water molecules, and this allows the physician to get images that represent efficiently the different types of tissues depending on their concentration in water molecules - highest in water and fat specifically. In order to focus on the tissue organization Diffusion MRI takes its place in giving out local characteristics of molecular diffusion. This time 2 pulses are applied and the motion of water molecules between these 2 sequences will be exhibited.

\subsection{Diffusion Tensor Imaging}

Magnetic resonance diffusion tensor imaging (DTI) is a method based on MRI and the diffusion mechanism of water molecules to assess the direction of fibers from the anisotropic property of the diffusion of these molecules in an oriented or elongated structure.

\subsubsection{Physical diffusion property of molecules}

In general the DTI signal is based on the proton of the hydrogen nucleus present in water molecules.

In a non-restrictive volume, the motion of molecules is Brownian and has a Gaussian distribution at equilibrium that is linked to the temperature of the environment and other properties. This Gaussian distribution will be affected by the presence of physical barriers that will decrease the diffusivity. Molecular motion will in fact be hindered in the direction perpendicular to the obstacles. When barriers are present the diffusion will change from isotropic to anisotropic. If we look at a free water molecule, its diffusion would have the shape of a sphere whereas with boundaries in the medium the diffusion of the same water molecule would be more of an ellipsoid with principal direction orthogonal to the boundaries.

\subsubsection{Diffusion weighted imaging} \label{dw_imaging}

Two short and intense successive pulsed field gradients (PFGs) are applied to the region of interest. The first makes protons have a precession phase proportional to their position along the direction of the gradient. Then a second one is applied with the exact opposite direction so that molecules that didn't move will have a null precession phase whereas those that moved will have a precession phase proportional to their motion in the direction of the PFG. Here we refer single water molecules but in reality we are considering a distribution of water molecules. For unbounded water molecules the distribution will be centered around a null motion whereas water molecules bounded by a rectangular container for instance will have a motion distribution centered around the direction of the longest vertex.
\begin{figure}
    \centering
    \includegraphics[width=.5\textwidth]{figures/pgse}
    \caption{Pulse Gradient Spin Echo (PGSE) sequence}
    \label{fig:pgse}
\end{figure}

The acquisition sequence, also called a Pulse Gradient Spin Echo (PGSE) sequence, can be described as follows: \cite{assemlal2011recent}
\begin{enumerate}
    \item A first PFG is applied in a direction orthogonal to the main magnetic field $\mathbf{B_0}$ for $t \in [0, \delta]$.\\
    This will have the effect of flipping the nuclear spins in the direction of the impulse
    \item Once the impulse is over, the magnetic moment of the nuclei will start dephasing as they will start rotating around the direction of $\mathbf{B_0}$, each of them with their specific frequency related to the strength of the magnetic field at their specific location
    \item After a diffusion time $t = \Delta$, another PFG is applied but this time with a direction opposite to the first impulse for $t \in [\Delta, \Delta + \delta]$, which will refocus the spin phases
    \item Finally at the echo time $t = TE$, the diffusion signal is received by the scanner coil with a loss proportional to the displacement of water molecules during this process. It is the information given by the displacement that is related to the micro structure of the studied environment.
\end{enumerate}

The equation of Nuclear Magnetic Resonance (NMR) was given by Stejskal and Tanner in 1965: it quantifies the decrease in signal intensity and relates this to the apparent diffusion coefficient $\mathbf{D}$.\\
Let $\mathbf{G}(t) = \Big(H\big(t - t_1\big) - H\big(t - (t_1 + \delta)\big)\Big)\mathbf{u} + \Big(H\big(t - t_2\big) - H\big(t - (t_2 + \delta)\big)\Big) \mathbf{v}$\\
where $\mathbf{u}, \mathbf{v}$ are unit vectors in the direction of the applied gradients, and $H(t)$ the Heaviside function at a given time $t$. This function is in fact the mathematical description of the PGSE sequence. Then we get the following Stejskal and Tanner equation \cite{Stejskaltanner}:

\begin{equation} \label{eq:tanner}
\frac{S(TE)}{S_0} = \exp\Big({-\gamma^2G^2\delta^2(\Delta - \frac{\delta}{3})\mathbf{G}^T\mathbf{D}\mathbf{G}\Big)} = \exp (-b \times \mathbf{D})
\end{equation}
where:

\begin{itemize}
    \item $\gamma$: gyromagnetic ratio, constant specific to each molecule
    \item $G$: PFG strength
    \item $\delta$: duration of the pulse
    \item $\Delta$: time between 2 pulses
    \item $\mathbf{D}$: apparent diffusion coefficient
    \item $b$ factor suggested by LeBihan \cite{lebihan1985imagerie}: $b = \gamma^2G^2\delta^2(\Delta - \frac{\delta}{3})||\mathbf{G}||^2$
\end{itemize}

\subsubsection{To get a diffusion tensor matrix} \label{diffusion_tensor_matrix}

Diffusion anisotropy can be described mathematically by a 3x3 diffusion tensor:
\begin{equation}
    \mathbb{D} = \begin{pmatrix}
    D_{xx} & D_{xy} & D_{xz} \\
    D_{yx} & D_{yy} & D_{yz} \\
    D_{zx} & D_{zy} & D_{zz}
    \end{pmatrix}
\end{equation}
with $D_{ij}$ the apparent diffusion coefficient (ADC) in direction $(i, j)$. In an environment dominated by water molecules, principles of thermodynamics dictate that $\mathbb{D}$ is symmetric, which means that $D_{ij} = D_{ji}$.

In conclusion we need at least 6 independent gradient directions to determine all 6 degrees of freedom in this matrix. In practice 7 directions are used to get more accurate results, along with a non-weighted measurement for normalization.

The values that we analyze most frequently are ADC and fracional anisotropy (FA). The ADC is an interesting measure as it can show difference in average diffusion values from one region to another - it was particularly adopted to assess the severity of injury in adult stroke patients. It has been challenged recently as it is extremely sensitive to tissue microstructure. As for the FA, it is a very interesting measurement that reflects fiber density and diameter.
\begin{equation}
    ADC = \frac{tr{\mathbb{D}}}{3} = \frac{\lambda_1 + \lambda_2 + \lambda_3}{3}
\end{equation}
\begin{equation}
    FA = \sqrt{\frac{(\lambda_1 - \lambda_2)^2 + (\lambda_2 - \lambda_3)^2 + (\lambda_3 - \lambda_1)^2}{\lambda_1^2 + \lambda_2^2 + \lambda_3^2}}
\end{equation}

\subsection{Heart fiber geometry}

From the 1970s, papers have shown how myofibers in the left ventricle (LV) are aligned along helical curves \cite{savadjiev2012heart}. This alignment has proved to be optimal for its mechanical function. Heart fibers stay locally packed together and almost parallel to each other, although they are bundled into a special surface: a generalized helicoid \cite{blair1978generalization}. This is a minimal surface that maintains this property through the whole beat cycle. The bundle of myofibers in generalized helicoids appears to be a characteristic feature through the heart wall \cite{pami2015, savadjiev2012heart}.

\subsubsection{The Generalized Helicoid Model (GHM)}

We will introduce a local frame field $\mathbf{f}_1,\mathbf{f}_2,\mathbf{f}_3 : \mathbb{R}^3 \to \mathbb{R}^3$ that will allow us to describre more easily the GHM. In this description, we follow the same local frame field definition as chosen in previous publications \cite{pami2015, savadjiev2012heart}:
\begin{itemize}
    \item $\mathbf{f}_1$ is the local orientation of the fiber
    \item $\mathbf{f}_3$ is the local heart wall normal
    \item $\mathbf{f}_2 = \frac{\mathbf{f}_3 \times \mathbf{f}_1}{||\mathbf{f}_3 \times \mathbf{f}_1||}$: to get a right-handed orthogonal coordinate frame field
\end{itemize}

\begin{figure}
    \centering
    \includegraphics[width=.5\textwidth]{figures/frame_fields}
    \caption{Examples of possible local frame fields in a world coordinate system $(x, y, z)$}
    \label{fig:frame_fields}
\end{figure}

In the GHM model the fiber orientation is expressed at each point $(x, y, z) \in \mathbb{R}^3$ by the function:
\begin{equation}
\theta (x, y, z) = \arctan \Bigg( \frac{K_Tx + K_Ny}{1 + K_Nx - K_Ty} \Bigg) + K_Bz
\end{equation}
where $\theta$ is the angle $\angle (\overrightarrow{x}, \overrightarrow{y})$
\begin{itemize}
    \item $K_T$ causes bending in the tangent direction to the fiber
    \item $K_N$ makes fibers fan out, away from each other, or towards each other, depending on its sign, in the $\mathbf{f}_2$ direction
    \item $K_B$ copies rotated versions of the fiber in planes parallel to the original $(x, y)$ plane, i.e. in the direction orthogonal to the heart wall
\end{itemize}
In general those values describe the amount of change in fiber orientation when going in each of the direction: tangential, orthogonal and out of plane.

Analyses of these parameters on different species has shown on the entire heart volume \cite{savadjiev2012heart} that the GHM fits with small values of $K_T$ and $K_N$ and high values of $K_B$. This validates the helicoidal model approach and the characteristic of the helix angle in heart myofiber structure.

From this analysis of helix angle using a model based description (GHM), by that we mean a fixed reference frame to measure parameters, we shall now another approach that is model free. The method of moving frames we will introduce in the next section allows us to have a reference frame that can be redefined for each fiber we are focusing on. Whereas in the GHM model, the variation of connection form parameters are coupled such that there are only 3 degrees of freedom ($K_T, K_N$ and $K_B$) once the frame is fixed, in the model free approach all 9 connection form parameters can vary.

\subsubsection{The Maurer-Cartan form}

The Maurer-Cartan form operator has proved useful in measuring the differential structure of a manifold, and the theory of moving frame has shown good results in the modeling of the heart fiber geometry \cite{pami2015}. The main idea is to apply the theory of moving frames but reverse it: tuning the Maurer-Cartan connection forms can enable us to generate manifolds based on assumptions on the structure that represent in the best way possible the actual heart fiber structure. This approach can be executed by using different fitting methods.

\paragraph{Theory of moving frames}

We utilize the framework described in \cite{de1990ventricular} to describe the geometry of fiber orientation in the heart wall via rotations of a frame field that is fit to the diffusion MRI data. 

Let a point $\mathbf{x} = \sum_i{x_i\mathbf{e_i}} \in \mathbb{R}^3$ be expressed in terms of $(\mathbf{e_1}, \mathbf{e_2}, \mathbf{e_3})$, the natural basis for $\mathbb{R}^3$.\\
We define a right-handed orthonormal frame field $\mathbf{f}_1,\mathbf{f}_2,\mathbf{f}_3 : \mathbb{R}^3 \to \mathbb{R}^3$.\\
Each frame axis can be expressed by the rigid rotation $f_i = \sum_i{a_{i,j}\mathbf{e}_j}$, where $\mathbf{A} = {a_{i,j}} \in \mathbb{R}^{3 \times 3}$ is a differentiable attitude matrix such that $\mathbf{A}^{-1} = \mathbf{A}^T$.\\
Treating $\mathbf{f}_i$ and $\mathbf{e}_j$ as symbols, we can write:
\begin{equation}
\begin{bmatrix}
    \mathbf{f}_1 \\
    \mathbf{f}_2 \\
    \mathbf{f}_3
\end{bmatrix} = \mathbf{A} \times \begin{bmatrix}
    \mathbf{e}_1 \\
    \mathbf{e}_2 \\
    \mathbf{e}_3
\end{bmatrix}
\end{equation}
Since each $\mathbf{e}_i$ is constant, the differential geometry of the frame field is completely characterized by $\mathbf{A}$. Taking the exterior derivative on both sides, we have:

\begin{align} \label{eq:1}
    \partial \begin{bmatrix}
                \mathbf{f}_1 \\
                \mathbf{f}_2 \\
                \mathbf{f}_3
            \end{bmatrix} &= (\partial \mathbf{A})\mathbf{A}^{-1}  \begin{bmatrix}
                \mathbf{f}_1 \\
                \mathbf{f}_2 \\
                \mathbf{f}_3
            \end{bmatrix} \\
            &= \mathbf{C}
            \begin{bmatrix}
                \mathbf{f}_1 \\
                \mathbf{f}_2 \\
                \mathbf{f}_3
            \end{bmatrix}
\end{align}
where $\partial$ denotes the exterior derivative, and $\mathbf{C} = (\partial \mathbf{A}) \mathbf{A}^{-1} = (c_{i,j}) \in \mathbb{R}^{3 \times 3}$ is the Maurer-Cartan matrix of connection forms $(c_{i,j})$.\\
Writing $\mathbf{f}_i$ as symbols, Eq. \ref{eq:1} is to be understood as $\partial \mathbf{f}_i = \sum_j{c_{i,j}\mathbf{f}_j}$.

The Maurer-Cartan matrix is skew symmetric with zeros as diagonal entries so there are at most 3 independent, non-zero 1-forms: $c_{12}$, $c_{13}$, and $c_{23}$.

\begin{equation}
    \mathbf{C} = \begin{pmatrix}
    0 & c_{12} & c_{13} \\
    -c_{12} & 0 & c_{23} \\
    -c_{13} & -c_{23} & 0
    \end{pmatrix}
\end{equation}
1-forms operate on tangent vectors through contraction, written as $\partial \omega \langle \boldsymbol{\upsilon} \rangle \in \mathbb{R}$ for a general 1-form $\partial \omega = \sum_i{\omega_i \mathbf{e_i}}$ and tangent vector $\boldsymbol{\upsilon} \in \mathbb{R}^3$, which yields:

\begin{align}
    \partial \omega \langle \boldsymbol{\upsilon} \rangle &= \sum_i{\omega_i \partial \mathbf{e_i}} \big{\langle} \sum_j{\upsilon_j \mathbf{e_j}} \big{\rangle} \\
    &= \sum_i{\omega_i \upsilon_i}
\end{align}
since
\begin{equation}
    \partial \mathbf{e}_i \langle \mathbf{e}_j \rangle = \delta_{i,j}
\end{equation}
where $\delta_{i,j}$ is the Kronecker delta.
It turns out that the space of linear models for smoothly varying frame fields is parametrized by the 1-forms $c_{i,j}$. Since only 3 unique non-zero combinations of $c_{i,j}$ are possible, there are in total 9 connections $c_{ijk}$ that fully characterize the local frame field geometry.

\paragraph{Tuning connection form parameters by energy minimization} \label{fitting_method}

\begin{figure}[!t]
    \centering
    \includegraphics[width=.78\textwidth]{figures/fibers_neighborhood3d}
    \caption{Example of a fiber neighborhood of 27: the center fiber (dark blue) is where we will have a first guess for the values of the connection forms $c_{ijk}$ and then will run an energy minimization algorithm to come up with parameters that give the same orientation for the neighbors as we can see in the ground truth here}
    \label{fig:fibers_neighborhood3d}
\end{figure}

Finding out the correct values for the connection form parameters $c_{ijk}(\mathbf{x}), \forall \mathbf{x} \in \mathbb{R}^3$ is done by energy minimization within a neighborhood $\Omega$, as we can see in Fig. \ref{fig:fibers_neighborhood3d}. This approach makes sense as the GHM is still dependent on the location in the heart, indeed the rate of turning will not be the same close to the apex for instance or where the heart wall is thinner.\\
Therefore the optimal parameters are defined as follows:
\begin{align*}
    c^*_{i,j,k}(\mathbf{x}) &= \text{argmin}_{c_{ijk}} \frac{1}{\Omega} \sum_{\mathbf{v} \in \Omega} \sum_{i = 1}^3 \epsilon_i(\mathbf{x} + \mathbf{v}) \\
    \epsilon_i(\mathbf{x} + \mathbf{v}) &= \arccos \Big( \mathbf{f}_i(\mathbf{x} + \mathbf{v}) . \mathbf{\tilde{f}}_i(\mathbf{x} + \mathbf{v}) \Big)
\end{align*}
where:
\begin{itemize}
    \item $\epsilon_i$ is the error function for each axis 
    \item $\mathbf{f}_i$ is the actual frame orientation at this location
    \item $\mathbf{\tilde{f}}_i$ is the current approximation of the frame orientation
\end{itemize}
The optimization strategy can be one of the standard well-known algorithms for these specific tasks: either Nelder-Mead \cite{press2007numerical} or BOBYQA \cite{powell2009bobyqa}.

\subsubsection{Combining both for a good description of heart fiber geometry}

The heart is made of elongated muscle cells called cardiomyocytes that are organized within a collagen matrix. The macroscopic shape is one of a truncated ellipsoid, while on a microscopic scale myocytes are stacked and form myofibers \cite{streeter1969fiber}.

Work on histology has shown how cardiac myofibers wrap around the ventricles in helical curves \cite{buckberg2002basic}. The ubiquitous analysis of myofiber geometry states out that the helix angle - $\theta$ or $c_{123}$ in previous sections, or the angle $\angle (\overrightarrow{\mathbf{f}^{i}_1}, \overrightarrow{\mathbf{f}^{i+1}_2})$ where $i$ is a tangent plane to the heart wall at this location - varies smoothly in Fig. \ref{fig:helix_angle} with a total change in Fig. \ref{fig:total_angle} of around 120° for mammals.
\begin{figure}[!t]
    \centering
    \includegraphics[width=.58\textwidth]{figures/total_angle}
    \caption[b]{Visualization of the helix angle with a transmural point of view}
    \label{fig:total_angle}
\end{figure}
\begin{figure}[!t]
    \includegraphics[width=.58\textwidth]{figures/helix_angle}
    \caption{The helix angle varies smoothly from one tangent plane to the other from the epicardium to the endocardium}
    \label{fig:helix_angle}
\end{figure}

Applying this method to the heart can be done by choosing $\mathbf{f}_i$ as described previously in the GHM model. $\mathbf{f}_1$ is easy to set from the DTI data, while $\mathbf{f}_3$ is determined locally by an approximation of the transmural direction at each location using a mask of the studied heart and a euclidian distance computed between the epicardium (outtermost layer of the heart wall) and endocardium (innermost layer) of the heart.

The Maurer-Cartan connection form approach is a good one to describe the cardiac frame field, where the 3 main geometrical features are exhibited by parameters of this model:
\begin{itemize}
    \item $c_{123}$ for the helix angle, or trans-mural penetration of the heart wall
    \item $c_{131}$ quantifies the short-axis (in plane for a given slice) curvature of the heart wall
    \item $c_{232}$ represents the long-axis (from one slice to another) curvature
\end{itemize}
As a reminder, in general, these coefficients $c_{ijk}$ express the rate of turn of the frame vector $\mathbf{f}_i$ towards $\mathbf{f}_j$ when $\mathbf{x}$ moves in the direction $\mathbf{f}_k$.

In previous sections we reviewed MRI and DMRI as they are the technologies involved in the acquisition of our data. Then a review of the GHM and the Maurer-Cartan forms helped us introduce the tools we rely on for the geometric characterization of fiber orientation. In the following section we provide the reader a brief review of infarcts and their effects, as it is the main application area of this thesis. This subject is particularly interesting as not much is yet known about how fibers are remodeled in the presence of infarcts.

\subsection{Infarcts and their impact on heart fiber geometry}

Studies have been trying to determine the consequences of myocardial infarctions in small (rat \cite{weisman1985global}) hearts and larger (porcine \cite{wu2007mr, mediamihaela}) hearts. In these studies it was shown that acute infarction led to a decrease in regional wall thickness and an increased radius of curvature, mostly in the border zone (BZ) - which is the zone close to the dense scar region but with a more heterogeneous nature due to the persistence of surviving blood vessels that continue to supply oxygen to isolated cells.

\subsubsection{Myocardial remodeling after infarct}

After an infarct occurs, a remodeling happens in the heart, which means that the normally existing structure goes through a rearrangement process as a result of the infarct \cite{swynghedauw1999molecular}. Cardiac Remodeling (CR) is determined by the following facts:
\begin{enumerate}
    \item An adaptation process of the myocytes and collagen to new geometrical conditions
    \item Fibrosis - increased collagen concentration, due to senescence - deterioration with age, ischemia, inflammatory processes
    \item cell death as a result of fibrosis, the major marker of cardiac failure
\end{enumerate}
One of the first consequences of CR is a decrease of the wall thickness, which leads immediately to an increased volume of the Left Ventricle (LV). Another direct effet is cardiac heart hypertrophy, with a multiplication of nonmuscle cells (fibroblasts and endothelial cells) in the place of former muscle myocytes. A study on rats \cite{mccormick1994regional} showed that the hypertrophy lead to a 25\% increase of the heart mass 13 weeks after infarct.

Myocardial fibrosis is one of the major signs of malignancy in the CR process, which can lead to death by cardiac failure (CF) or severe arrhythmias.

\subsubsection{Effects of wall stress on tissue composition and geometry}

A main problem in the study of the consequences of an infarct on a mammal heart is the important cost that it involves. As imaging is expensive, only a few were carried out, which makes the analysis even more specific to the few examples available for study \cite{holmes1994scar}. Several experiments still have been made and the following chronological evolution of the cardiac fiber geometry emerged:
\begin{itemize}
    \item Local infarct expansion 1 week after the initial infarct, characterized by a stretch in a plane tangent to the epicardium and wall thinning.
    \item Scar shrinkage 3 weeks after infarction. The CR, even without reestablishing a contractile function as efficient as before the infarct, works around the infarct to compensate the work overload on the scar region.
    \item Alignment of myocardial collagen fibers with the direction of the greatest applied stress, which takes place during infarct healing
\end{itemize}

\subsubsection{Characteristics of collagen in infarcted hearts and arrangement of the surviving fibers} \label{surviving_fibers}

Studies \cite{mccormick1994regional} have shown that after the occurrence of an infarct the whole heart mass increase by an average of 25\%. The infarcts were affecting the LV, and the difference in the LV mass could involve up to 58\% increase.

A major impact of an infarct on the heart is on the collagen concentration that goes up significantly both in the scar tissue, the Border Zone (BZ) which is specifically rich in fibrosis and in more distant regions. The concentration of collagen can double in the most affected regions of the heart. In general and throughout the whole heart the collagen concentration increases dramatically and is combined with more cross-linking of these cells.

Studies on human hearts \cite{de1990ventricular} have shown that arrhythmias and tachycardia can be caused by abnormal membrane variables and abnormal geometrical arrangement of the myocardial fibers.

Transmembrane potentials were taken and these showed little difference between patients with ventricular tachycardia in a chronic phase of myocardial infarction and normal patients. This clearly indicates that the surviving myocardial fibers within an infarct can come back close to normal after a CR process. Surviving bundles in the subendocardial layers have also been observed, as well as intramurally and subepicardially. These bundles of surviving myocytes showed an anisotropy similar to the papillary muscle of the heart, and therefore a similar coupling resistance, which makes sense as the activation signal propagates itself like a zigzag through the infarcted region of the heart.

After a transmural myocardial infarction, the outtermost epicardial muscle survives and its structure contributes greatly in the occurence of the reentry. These surviving muscle cells in the BZ of the epicardium are like a thin sheet over the infarct. The connections with other rare intramural muscle is not present very often, and this means that the impulses are only 2-dimensional as they cannot come from below, which prevents an appropriate circus movement and can lead to tachycardia \cite{ursell1985structural}.

\section{Experimental Setup}

The data on which our results are based are all porcine hearts that were provided to us by Dr. Mihaela Pop of the Sunnybrooke Research Institute and the Department of Medical Biophysics at the University of Toronto.

\subsection{Data acquisition of pig infarcted and healthy hearts}

Each porcine heart studied in this thesis were freshly excised, suspended in a plexiglass phantom filled with fluorinert (to eliminate artifacts) and placed in an MR head coil for ex-vivo imaging. All DW-MR studies were performed on a dedicated 1.5T GE Signa Excite scanner using a custom FSE pulse sequence. They used the following MR parameters \cite{pmbpop2013quantification}: 
\begin{itemize}
    \item $TE = 35$ ms
    \item $TR = 700$ ms
    \item echo train length $=2$
    \item $b = 0$ for the unweighted MR images. As a reminder, the b factor is explained in Section \ref{dw_imaging}
    \item $b = 500 $ s/$\text{mm}^2$ for the images where the 7 diffusion gradients were applied
    \item $256 \times 256$ k-space
    \item Field of View $FOV = 10-16$ cm
    \item Slice Thickness $ = 1.2$ mm, yielding a sub-millimetric voxel size
\end{itemize}
From each heart, select samples containing an infarct were cut to align with the short-axis view of the MR images and prepared for histopathology to confirm the collagen deposition in the infarct area.

\begin{figure}[t!]
    \centering
    \includegraphics[width=.78\textwidth]{figures/Gip4_histology}
    \caption{Histology of a slice of infarcted heart analyzed in \cite{pmbpop2013quantification}}
    \label{fig:histology_pig_4}
\end{figure}

One of the difficulties that remains is to try and find a good correspondence between the slices from the histology and the ones that were obtained from the imaging that occured before the histopathology was performed. Fig. \ref{fig:histology_pig_4} shows a histology image of a slide from an infarcted heart, with intact myocytes in the normal tissue and altered tissue microstructure in the infarcted zone. As depicted by the Masson Trichrome stain, the ischemic border zone (BZ) had collagen fibrils interdigitated between viable myocytes. In the dense scar area, necrotic myocytes were completely replaced by mature fibrosis (the final product of collagen degradation), resulting in the loss of myocardial anisotropy.

\subsection{Source of input data}

The data we used \cite{pmbpop2013quantification} are DT-MRI of porcine hearts. Of these 8 hearts had infarcts while 2 were healthy. For every infarcted heart, the imaging process took place 6 weeks after the occurence of the infarct and histological section was carried out after that for some of the cases. The availability of some histological data allows us to compare our analysis qualitatively with measurements that serve as ground truth. We provide  in Table \ref{tab:hearts} an overview of the data we had access to and its usability.

\begin{table}
    \centering
    \begin{tabular}{|c | c | c | c|} 
         \hline
         \shortstack{Heart \\ (Acquisition Date)} & Infarcted or Healthy & Region of infarct \\
         \hline
         2 & Infarcted & \shortstack{Left Circumflex artery \\ (LCX)} \\ 
         \hline
         4 & Infarcted & \shortstack{Left Anterior Descending \\ (LAD)} \\
         \hline
         5 & Infarcted & LCX \\
         \hline
         6 & Infarcted & LCX \\
         \hline
         7 & Infarcted & \shortstack{Rigth Coronary Artery \\ (RCA)} \\ 
         \hline
         17 & Infarcted & Bad quality \\
         \hline
         18 & Infarcted & Bad quality \\
         \hline
         23 & Infarcted & Unreadable \\
         \hline
         25 & Healthy & - \\
         \hline
         28 & Healthy & Too Noisy \\
         \hline
    \end{tabular}
    \caption{Description of our available datasets}
    \label{tab:hearts}
\end{table}

\subsection{Quality of our data}

For a better and more accurate analysis of our results, we will focus mostly on the best quality data (least noisy) we had access to and fortunately this includes one control heart (\#5: Fig. \ref{fig:pig25}) and 5 infarcted hearts (\#2: Fig. \ref{fig:pig2}, \#4: Fig. \ref{fig:pig4}, \#5: Fig. \ref{fig:pig5}, \#6: Fig. \ref{fig:pig6}, \#7: Fig. \ref{fig:pig7}).

Due to the imaging technology used, and to the fact that a fairly low Tesla MRI scanner was used to acquire this data (1.5T), a good amount of noise is present in the raw data. We have taken advantage of knowledge for the type of noise (Rician noise) that is present in MRI-acquired data to apply non-local denoising strategies which are able to better reconstruct the fiber orientation without oversmoothing \cite{Basu2006RicianNR}. The probability distribution differs from a Gaussian distribution by a factor of the signal which makes the mapping non-linear.
\begin{itemize}
    \item Gaussian: $P(x | \sigma, \mu) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp^{-\frac{(x - \mu)^2}{2\sigma^2}}$
    \item Rician: $P(x | \sigma, \nu) = \frac{x}{\sigma^2}\exp^{-\frac{(x^2 + \nu^2)}{2\sigma^2}}I_0\Big(\frac{x\nu}{2\sigma^2}\Big)$
\end{itemize}

The distribution distribution is therefore far from being Gaussian for small Signal-To-Noise (SNR) ratios. This prevents this strategy from smoothing even regions where the data is chaotic due to the infarct or proximity to the boundary and not only because of noise issues from acquisition. A fine tuning of the smoothing strategy allowed us to get good quality datasets without removing relevant information in regions of interest around the infarcts.

\subsection{Usage of MedInria software to read the DICOMs}

We took the advantage of the MedInria tool to load the DICOM images, pre-process the data via Rician denoising and finally use its Diffusion Tensor Imaging tool to compute the value of the tensor matrix (detailed in Section \ref{diffusion_tensor_matrix}) at each voxel location in the heart.

From the tensor matrices at every location, we were easily able to compute the fiber orientation at every location. Cylindrical consistency was used to enforce a consistent sense throughout the heart.

Once we have the fiber orientation at every voxel, we can use our previous work to compute the connection forms and get a sense of the quality of the fitting, as we will see more in detail in the following chapter.