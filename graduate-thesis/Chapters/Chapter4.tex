\chapter{Methodology}

\section{Modeling fiber geometry using connection forms}

 The histograms of $c_{1,2,3}$ for these cases are discussed in Section ???. \\
\begin{figure}[h!]
    \centering
    \begin{subfigure}[h!]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/c123}
        \caption{$c_{1,2,3}$}
        \label{fig:c123theory}
    \end{subfigure}
    \hfill
    \begin{subfigure}[h!]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/pig4_c123_slice_19}
        \caption{$c_{1,2,3}$ (infarcted)}
        \label{fig:c123infarcted}
    \end{subfigure}
    \hfill
    \begin{subfigure}[h!]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/pig25_c123_slice_30}
        \caption{$c_{1,2,3}$ (healthy)}
        \label{fig:c123healthy}
    \end{subfigure}
    \caption{$c_{1,2,3}$ with range of values in porcine hearts}
    \label{fig:c123all}
\end{figure}

 Connection forms measure the local rotations of the frame axes $\mathbf{f}_1, \mathbf{f}_2, \mathbf{f}_3$. Here we focus on the contraction of the 1-form $c_{1,2}$ on the frame axes $\mathbf{f}_3$ and compare its values in a short axis slice of a pig heart with an infarct \ref{fig:c123infarct} with those in a short axis slice from a healthy pig heart \ref{fig:c123healthy}. \\
 
 \begin{figure}
     \centering
     \includegraphics[width=\textwidth]{figures/pig4_error_of_fit_slice_19}
     \caption{Error of fit}
     \label{fig:error_of_fit}
 \end{figure}
 
Cartan frame field analysis applies to smoothly rotating frame fields. In the presence of infarcts fiber orientation coherence is lost. The connections then fail to explain the orientation of fibers in a local neighborhood and fitting errors using this method go up \ref{fig:error_of_fit}. This association of frame field fitting error with fiber incoherence is the key insight behind the developments in this paper.

\section{Cartan Frame Fitting and Error Analysis}

As explained earlier, at each voxel we use an estimate of the fiber orientation given by the orientation of the first principal eigen vector of a diffusion tensor reconstruction for $\mathbf{f}_1$. We then estimate the heart wall normal as the gradient of the distance function to the boundary of the myocardium and take the component of the normal that is orthogonal to $\mathbf{f}_1$ to be $\mathbf{f}_3$. $\mathbf{f}_2$ is then taken to be their cross product. Our numerical implementation of frame field fitting relies on finding the best estimates of the 9 connections at each voxel in the sense of explaining the orientations in its neighborhood. Specifically, using Nelder-Mead optimization, we minimize an energy given by the angle between the measured orientation at each neighbor and that given by rotating the frame field by a particular set of connections. Once this method converges the error of fit at a voxel is taken to be the average angular error between fiber orientations in a neighborhood and those given by rotating the frame at that voxel using its connection parameters.